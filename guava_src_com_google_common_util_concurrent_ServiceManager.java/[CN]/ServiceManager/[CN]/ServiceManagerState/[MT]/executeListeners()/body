{
  checkState(!monitor.isOccupiedByCurrentThread(),"It is incorrect to execute listeners with the monitor held.");
synchronized (queuedListeners) {
    Runnable listener;
    while ((listener=queuedListeners.poll()) != null) {
      listener.run();
    }
  }
}
