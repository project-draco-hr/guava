{
  if (type instanceof Class) {
    return (Class<?>)type;
  }
 else   if (type instanceof ParameterizedType) {
    ParameterizedType parameterizedType=(ParameterizedType)type;
    return (Class<?>)parameterizedType.getRawType();
  }
 else   if (type instanceof GenericArrayType) {
    GenericArrayType genericArrayType=(GenericArrayType)type;
    return Types.getArrayClass(getRawType(genericArrayType.getGenericComponentType()));
  }
 else   if (type instanceof TypeVariable) {
    return getRawType(((TypeVariable<?>)type).getBounds()[0]);
  }
 else   if (type instanceof WildcardType) {
    return getRawType(((WildcardType)type).getUpperBounds()[0]);
  }
 else {
    throw new AssertionError(type + " unsupported");
  }
}
