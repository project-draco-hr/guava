{
  lock.lock();
  try {
    if (snapshot.state == State.NEW) {
      snapshot=new StateSnapshot(State.STARTING);
      starting();
      doStart();
    }
  }
 catch (  Throwable startupFailure) {
    notifyFailed(startupFailure);
  }
 finally {
    lock.unlock();
    executeListeners();
  }
  return startup;
}
