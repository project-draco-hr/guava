{
  checkNotNull(listener,"listener");
  checkNotNull(executor,"executor");
  lock.lock();
  try {
    State currentState=state();
    if (currentState != State.TERMINATED && currentState != State.FAILED) {
      listeners.add(new ListenerExecutorPair(listener,executor));
    }
  }
  finally {
    lock.unlock();
  }
}
