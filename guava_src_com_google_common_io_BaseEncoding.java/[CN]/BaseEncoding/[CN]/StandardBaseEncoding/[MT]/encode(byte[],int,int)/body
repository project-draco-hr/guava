{
  checkNotNull(bytes);
  checkPositionIndexes(off,off + len,bytes.length);
  int outputLength=charsPerChunk * divide(len,bytesPerChunk,CEILING);
  StringBuilder builder=new StringBuilder(outputLength);
  int bitBuffer=0;
  int bitBufferLength=0;
  for (int i=off; i < off + len; i++) {
    bitBuffer<<=8;
    bitBuffer|=bytes[i] & 0xFF;
    bitBufferLength+=8;
    while (bitBufferLength >= bitsPerChar) {
      int charIndex=(bitBuffer >>> (bitBufferLength - bitsPerChar)) & alphabetMask;
      builder.append(alphabet.charAt(charIndex));
      bitBufferLength-=bitsPerChar;
    }
  }
  if (bitBufferLength > 0) {
    int charIndex=(bitBuffer << (bitsPerChar - bitBufferLength)) & alphabetMask;
    builder.append(alphabet.charAt(charIndex));
    if (paddingChar != null) {
      while (builder.length() % charsPerChunk != 0) {
        builder.append(paddingChar.charValue());
      }
    }
  }
  return builder.toString();
}
