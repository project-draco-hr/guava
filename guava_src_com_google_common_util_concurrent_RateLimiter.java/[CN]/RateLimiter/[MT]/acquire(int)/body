{
  checkPermits(permits);
  long microsToWait;
synchronized (this) {
    microsToWait=reserveNextTicket(permits,readSafeMicros());
  }
  ticker.sleepMicrosUninterruptibly(microsToWait);
}
