{
  ThrowOnRunService service=new ThrowOnRunService();
  service.throwOnShutDown=true;
  service.startAsync().awaitRunning();
  executionThread.join();
  assertTrue(service.shutDownCalled);
  assertEquals(Service.State.FAILED,service.state());
  assertEquals("kaboom!",thrownByExecutionThread.getMessage());
}
