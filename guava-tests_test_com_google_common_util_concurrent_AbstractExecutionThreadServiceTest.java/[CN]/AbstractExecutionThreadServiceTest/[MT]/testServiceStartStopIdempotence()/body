{
  WaitOnRunService service=new WaitOnRunService();
  service.start();
  service.start();
  service.startAndWait();
  assertEquals(Service.State.RUNNING,service.state());
  service.startAndWait();
  assertEquals(Service.State.RUNNING,service.state());
  enterRun.await();
  service.stop();
  service.stop();
  service.stopAndWait();
  assertEquals(Service.State.TERMINATED,service.state());
  service.stopAndWait();
  assertEquals(Service.State.TERMINATED,service.state());
  assertEquals(Service.State.RUNNING,service.start().get());
  assertEquals(Service.State.RUNNING,service.startAndWait());
  assertEquals(Service.State.TERMINATED,service.stop().get());
  assertEquals(Service.State.TERMINATED,service.stopAndWait());
  executionThread.join();
  assertNull(thrownByExecutionThread);
}
