{
  Set<E> incidentEdgesN1=incidentEdges(node1);
  if (node1.equals(node2)) {
    if (!config.isSelfLoopsAllowed()) {
      return ImmutableSet.of();
    }
    Set<E> selfLoopEdges=Sets.filter(incidentEdgesN1,Graphs.selfLoopPredicate(this));
    return Collections.unmodifiableSet(selfLoopEdges);
  }
  Set<E> incidentEdgesN2=incidentEdges(node2);
  return (incidentEdgesN1.size() <= incidentEdgesN2.size()) ? Sets.intersection(incidentEdgesN1,incidentEdgesN2) : Sets.intersection(incidentEdgesN2,incidentEdgesN1);
}
