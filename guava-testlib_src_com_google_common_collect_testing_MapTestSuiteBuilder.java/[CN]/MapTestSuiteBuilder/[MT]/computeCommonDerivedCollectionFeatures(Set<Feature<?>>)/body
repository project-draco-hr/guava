{
  Set<Feature<?>> derivedFeatures=new HashSet<Feature<?>>();
  if (mapFeatures.contains(CollectionFeature.SERIALIZABLE_INCLUDING_VIEWS)) {
    derivedFeatures.add(CollectionFeature.SERIALIZABLE);
  }
  if (mapFeatures.contains(MapFeature.SUPPORTS_REMOVE)) {
    derivedFeatures.add(CollectionFeature.SUPPORTS_REMOVE);
    derivedFeatures.add(CollectionFeature.SUPPORTS_REMOVE_ALL);
    derivedFeatures.add(CollectionFeature.SUPPORTS_RETAIN_ALL);
  }
  if (mapFeatures.contains(MapFeature.SUPPORTS_CLEAR)) {
    derivedFeatures.add(CollectionFeature.SUPPORTS_CLEAR);
  }
  if (mapFeatures.contains(MapFeature.REJECTS_DUPLICATES_AT_CREATION)) {
    derivedFeatures.add(CollectionFeature.REJECTS_DUPLICATES_AT_CREATION);
  }
  if (mapFeatures.contains(MapFeature.FAILS_FAST_ON_CONCURRENT_MODIFICATION)) {
    derivedFeatures.add(CollectionFeature.FAILS_FAST_ON_CONCURRENT_MODIFICATION);
  }
  if (mapFeatures.contains(CollectionFeature.KNOWN_ORDER)) {
    derivedFeatures.add(CollectionFeature.KNOWN_ORDER);
  }
  for (  CollectionSize size : CollectionSize.values()) {
    if (mapFeatures.contains(size)) {
      derivedFeatures.add(size);
    }
  }
  return derivedFeatures;
}
