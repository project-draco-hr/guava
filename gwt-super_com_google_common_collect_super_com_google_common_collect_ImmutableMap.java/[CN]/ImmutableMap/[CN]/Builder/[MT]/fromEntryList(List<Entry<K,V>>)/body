{
  int size=entries.size();
switch (size) {
case 0:
    return of();
case 1:
  Entry<K,V> entry=getOnlyElement(entries);
return new SingletonImmutableMap<K,V>(entry.getKey(),entry.getValue());
default :
@SuppressWarnings("unchecked") Entry<K,V>[] entryArray=entries.toArray(new Entry[entries.size()]);
return new RegularImmutableMap<K,V>(entryArray);
}
}
