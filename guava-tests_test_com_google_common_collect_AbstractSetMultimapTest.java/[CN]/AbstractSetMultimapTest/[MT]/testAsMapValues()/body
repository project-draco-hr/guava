{
  Multimap<String,Integer> multimap=create();
  Collection<Collection<Integer>> asMapValues=multimap.asMap().values();
  multimap.put("foo",1);
  multimap.put("foo",3);
  Collection<?>[] array=new Collection<?>[3];
  array[1]=Collections.emptyList();
  assertSame(array,asMapValues.toArray(array));
  assertEquals(Sets.newHashSet(1,3),array[0]);
  assertNull(array[1]);
  multimap.put("bar",3);
  assertTrue(asMapValues.containsAll(asList(Sets.newHashSet(1,3),Sets.newHashSet(3))));
  assertFalse(asMapValues.containsAll(asList(Sets.newHashSet(1,3),Sets.newHashSet(1))));
  assertFalse(asMapValues.remove(ImmutableSet.of(1,2)));
  assertEquals(3,multimap.size());
  assertTrue(asMapValues.remove(ImmutableSet.of(1,3)));
  assertEquals(1,multimap.size());
}
