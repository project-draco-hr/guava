{
  ThreadedService service=new ThreadedService();
  service.start().get();
  service.start();
  assertEquals(Service.State.RUNNING,service.state());
  service.awaitRunChecks();
  service.stop().get();
  service.stop();
  assertEquals(Service.State.TERMINATED,service.state());
  executionThread.join();
  throwIfSet(thrownByExecutionThread);
}
