{
  ManualSwitchedService service=new ManualSwitchedService();
  RecordingListener.record(service);
  service.startAsync();
  service.notifyFailed(new Exception("1"));
  service.notifyFailed(new Exception("2"));
  assertEquals("1",service.failureCause().getMessage());
  try {
    service.awaitRunning();
    fail();
  }
 catch (  IllegalStateException e) {
    assertEquals("1",e.getCause().getMessage());
  }
}
