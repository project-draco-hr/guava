{
  Set<String> unfiltered=Sets.newHashSet();
  Set<String> filtered=Sets.filter(Sets.filter(unfiltered,Collections2Test.LENGTH_1),Collections2Test.STARTS_WITH_VOWEL);
  unfiltered.add("a");
  unfiltered.add("b");
  unfiltered.add("apple");
  unfiltered.add("banana");
  unfiltered.add("e");
  assertEquals(ImmutableSet.of("a","e"),filtered);
  assertEquals(ImmutableSet.of("a","b","apple","banana","e"),unfiltered);
  try {
    filtered.add("d");
    fail();
  }
 catch (  IllegalArgumentException expected) {
  }
  try {
    filtered.add("egg");
    fail();
  }
 catch (  IllegalArgumentException expected) {
  }
  assertEquals(ImmutableSet.of("a","e"),filtered);
  assertEquals(ImmutableSet.of("a","b","apple","banana","e"),unfiltered);
  filtered.clear();
  assertTrue(filtered.isEmpty());
  assertEquals(ImmutableSet.of("b","apple","banana"),unfiltered);
}
