{
  ExecutorService e=new DirectExecutorService();
  try {
    List<Callable<String>> l=new ArrayList<Callable<String>>();
    l.add(new StringTask());
    l.add(Executors.callable(possiblyInterruptedRunnable(2 * SHORT_DELAY_MS),TEST_STRING));
    l.add(new StringTask());
    List<Future<String>> futures=e.invokeAll(l,SHORT_DELAY_MS,MILLISECONDS);
    assertEquals(3,futures.size());
    Iterator<Future<String>> it=futures.iterator();
    Future<String> f1=it.next();
    Future<String> f2=it.next();
    Future<String> f3=it.next();
    assertTrue(f1.isDone());
    assertFalse(f1.isCancelled());
    assertTrue(f2.isDone());
    assertFalse(f2.isCancelled());
    assertTrue(f3.isDone());
    assertTrue(f3.isCancelled());
  }
  finally {
    joinPool(e);
  }
}
