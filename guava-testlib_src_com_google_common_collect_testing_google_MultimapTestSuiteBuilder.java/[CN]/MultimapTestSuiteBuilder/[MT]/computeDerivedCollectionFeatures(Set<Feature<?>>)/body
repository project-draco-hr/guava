{
  Set<Feature<?>> derivedFeatures=Helpers.copyToSet(multimapFeatures);
  if (!derivedFeatures.remove(CollectionFeature.SERIALIZABLE_INCLUDING_VIEWS)) {
    derivedFeatures.remove(CollectionFeature.SERIALIZABLE);
  }
  if (derivedFeatures.remove(MapFeature.ALLOWS_NULL_QUERIES)) {
    derivedFeatures.add(CollectionFeature.ALLOWS_NULL_QUERIES);
  }
  if (derivedFeatures.remove(MapFeature.REMOVE_OPERATIONS)) {
    derivedFeatures.add(CollectionFeature.REMOVE_OPERATIONS);
  }
 else {
    if (derivedFeatures.remove(MapFeature.SUPPORTS_REMOVE)) {
      derivedFeatures.add(CollectionFeature.SUPPORTS_REMOVE);
    }
    if (derivedFeatures.remove(MapFeature.SUPPORTS_CLEAR)) {
      derivedFeatures.add(CollectionFeature.SUPPORTS_CLEAR);
    }
  }
  return derivedFeatures;
}
