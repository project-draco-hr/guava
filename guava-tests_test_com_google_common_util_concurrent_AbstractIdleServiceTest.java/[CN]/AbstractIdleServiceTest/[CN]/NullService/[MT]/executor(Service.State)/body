{
switch (state) {
case STARTING:
    assertFalse(startUpCalled);
  return executor;
case STOPPING:
assertTrue(startUpCalled);
assertFalse(shutDownCalled);
return executor;
default :
throw new IllegalStateException("unexpected state " + state);
}
}
