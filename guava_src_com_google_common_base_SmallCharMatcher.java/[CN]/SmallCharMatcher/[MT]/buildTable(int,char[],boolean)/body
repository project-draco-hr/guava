{
  char[] table=new char[modulus];
  for (int i=0; i < allChars.length; i++) {
    char c=allChars[i];
    int index=c % modulus;
    if (index < 0) {
      index+=modulus;
    }
    if ((table[index] != 0) && !reprobe) {
      return null;
    }
 else     if (reprobe) {
      while (table[index] != 0) {
        index=(index + 1) % modulus;
      }
    }
    table[index]=c;
  }
  return table;
}
