{
  LoadingCache<Object,Object> cache=CacheBuilder.newBuilder().recordStats().build(identityLoader());
  CacheStats stats=cache.stats();
  assertEquals(0,stats.missCount());
  assertEquals(0,stats.loadSuccessCount());
  assertEquals(0,stats.loadExceptionCount());
  assertEquals(0,stats.hitCount());
  Object key=new Object();
  assertSame(key,cache.get(key));
  stats=cache.stats();
  assertEquals(1,stats.missCount());
  assertEquals(1,stats.loadSuccessCount());
  assertEquals(0,stats.loadExceptionCount());
  assertEquals(0,stats.hitCount());
  key=new Object();
  assertSame(key,cache.getUnchecked(key));
  stats=cache.stats();
  assertEquals(2,stats.missCount());
  assertEquals(2,stats.loadSuccessCount());
  assertEquals(0,stats.loadExceptionCount());
  assertEquals(0,stats.hitCount());
  key=new Object();
  cache.refresh(key);
  checkNothingLogged();
  stats=cache.stats();
  assertEquals(2,stats.missCount());
  assertEquals(3,stats.loadSuccessCount());
  assertEquals(0,stats.loadExceptionCount());
  assertEquals(0,stats.hitCount());
  assertSame(key,cache.get(key));
  stats=cache.stats();
  assertEquals(2,stats.missCount());
  assertEquals(3,stats.loadSuccessCount());
  assertEquals(0,stats.loadExceptionCount());
  assertEquals(1,stats.hitCount());
  Object value=new Object();
  assertSame(key,cache.get(key,throwing(new Exception())));
  stats=cache.stats();
  assertEquals(2,stats.missCount());
  assertEquals(3,stats.loadSuccessCount());
  assertEquals(0,stats.loadExceptionCount());
  assertEquals(2,stats.hitCount());
  key=new Object();
  assertSame(value,cache.get(key,Callables.returning(value)));
  stats=cache.stats();
  assertEquals(3,stats.missCount());
  assertEquals(4,stats.loadSuccessCount());
  assertEquals(0,stats.loadExceptionCount());
  assertEquals(2,stats.hitCount());
}
