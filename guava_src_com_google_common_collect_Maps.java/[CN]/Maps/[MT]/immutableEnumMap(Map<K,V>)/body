{
  if (map instanceof ImmutableEnumMap) {
    return (ImmutableEnumMap<K,V>)map;
  }
 else   if (map.isEmpty()) {
    return ImmutableMap.of();
  }
 else {
    for (    Map.Entry<K,V> entry : map.entrySet()) {
      checkNotNull(entry.getKey());
      checkNotNull(entry.getValue());
    }
    return ImmutableEnumMap.asImmutable(new EnumMap<K,V>(map));
  }
}
