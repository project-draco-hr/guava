{
  if (n == 0) {
    return 0;
  }
  for (int i=0; i < n; i++) {
    ObjectArrays.checkElementNotNull(contents[i],i);
  }
  Arrays.sort(contents,0,n,comparator);
  int uniques=1;
  for (int i=1; i < n; i++) {
    E cur=contents[i];
    E prev=contents[uniques - 1];
    if (comparator.compare(cur,prev) != 0) {
      contents[uniques++]=cur;
    }
  }
  Arrays.fill(contents,uniques,n,null);
  return uniques;
}
